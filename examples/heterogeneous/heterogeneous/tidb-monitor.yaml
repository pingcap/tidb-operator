apiVersion: pingcap.com/v1alpha1
kind: TidbMonitor
metadata:
  name: heterogeneous
spec:
  clusters:
  - name: heterogeneous
  prometheus:
    baseImage: prom/prometheus
    version: v2.18.1
    service:
      type: ClusterIP
      portName: http-prometheus
    config:
      configMapRef:
        name: heterogeneous-external-config
  grafana:
    baseImage: grafana/grafana
    version: 6.1.6
  initializer:
    baseImage: pingcap/tidb-monitor-initializer
    version: v4.0.0
  reloader:
    baseImage: pingcap/tidb-monitor-reloader
    version: v1.0.1
  imagePullPolicy: IfNotPresent
  additionalContainers:
    - name: thanos
      image: quay.io/thanos/thanos:v0.8.1
      args:
        - sidecar
        - --prometheus.url=http://localhost:9090/
        - --tsdb.path=/data/prometheus
        - --grpc-address=0.0.0.0:10901
        - --http-address=0.0.0.0:10902
      env:
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
      volumeMounts:
        - name: monitor-data
          mountPath: /data